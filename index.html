<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>クリスマスイベント リアル脱出ゲーム</title>
    <style>
        /* --- 全体設定 --- */
        html, body {
            margin: 0;
            padding: 0;
            overflow-x: hidden;
        }

        body {
            background-color: #0d0d0d;
            color: #e0e0e0;
            font-family: 'Helvetica Neue', Arial, 'Hiragino Sans', Meiryo, sans-serif;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            padding: 20px;
            min-height: 100vh;
        }

        /* --- コンテナ --- */
        .container {
            width: 100%;
            max-width: 650px;
            background-color: #1e1e1e;
            padding: 30px;
            border-radius: 10px;
            border: 1px solid rgba(0,255,255,0.3);
            box-shadow: 0 0 30px rgba(0,255,255,0.25);
            position: relative;
            z-index: 10;
        }

        h1 {
            color: #00ffff;
            margin-bottom: 25px;
            text-shadow: 0 0 10px #00ffff;
        }

        p {
            line-height: 1.6;
        }

        /* --- 謎一覧 --- */
        .question-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 24px;
        }

        .question-item {
            background-color: #262626;
            padding: 16px;
            border-radius: 10px;
            border: 1px solid #444;
        }

        .riddle-img {
            max-width: 100%;
            border-radius: 6px;
            border: 1px solid #555;
            margin-bottom: 12px;
        }

        /* --- 回答欄 --- */
        input[type="text"] {
            width: 100%;
            padding: 12px;
            background-color: #e6e6e6;
            border: 1px solid #888;
            border-radius: 5px;
            color: #000;
            font-size: 1em;
        }

        input[type="text"]::placeholder { color: #666; }

        input[type="text"]:focus {
            outline: none;
            border-color: #00ffff;
            box-shadow: 0 0 10px rgba(0,255,255,0.5);
        }

        /* --- ボタン --- */
        .btn {
            margin-top: 20px;
            padding: 12px 30px;
            background: linear-gradient(45deg, #00ffff, #0077ff);
            color: #000;
            font-weight: bold;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            font-size: 1.1em;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,255,255,0.4);
        }

        #feedback-message,
        #final-feedback-message {
            color: #ff5555;
            font-weight: bold;
            min-height: 24px;
            margin-top: 12px;
        }

        /* --- 最終問題 --- */
        #riddle-image {
            max-width: 80%;
            margin-top: 20px;
            border-radius: 6px;
            border: 1px solid #666;
        }

        /* --- 隠す --- */
        .hidden { display: none; }


        /* ======================== */
        /*   CLEAR 演出（豪華版）   */
        /* ======================== */

        /* キラキラ背景エフェクト */
        .clear-bg {
            position: fixed;
            top: 0; left: 0;
            width: 100vw; height: 100vh;
            pointer-events: none;
            background: radial-gradient(circle, rgba(0,255,200,0.25), transparent 70%);
            animation: pulse 3s infinite;
            z-index: 1;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.6; }
        }

        /* CLEAR テキストのフェードイン */
        .clear-title {
            animation: fadeIn 2s ease forwards, glow 2s infinite alternate;
            opacity: 0;
        }

        @keyframes fadeIn {
            to { opacity: 1; }
        }

        @keyframes glow {
            0% { text-shadow: 0 0 10px #00ffbf; }
            100% { text-shadow: 0 0 30px #00ffbf, 0 0 50px #00ffee; }
        }

    </style>
</head>
<body>

<div class="clear-bg hidden" id="clear-bg"></div>

<div class="container">

    <!-- ステップ1 -->
    <div id="step1">
        <h1>リアル脱出ゲームサークルからの挑戦状</h1>
        <p>7つの謎を解き、答えを<strong>ひらがな</strong>で入力してください。</p>

        <div class="question-grid">

            <div class="question-item"><img src="images/q1.png" class="riddle-img"><input id="q1" type="text" placeholder="入力してください…"></div>
            <div class="question-item"><img src="images/q2.png" class="riddle-img"><input id="q2" type="text" placeholder="入力してください…"></div>
            <div class="question-item"><img src="images/q3.png" class="riddle-img"><input id="q3" type="text" placeholder="入力してください…"></div>
            <div class="question-item"><img src="images/q4.png" class="riddle-img"><input id="q4" type="text" placeholder="入力してください…"></div>
            <div class="question-item"><img src="images/q5.png" class="riddle-img"><input id="q5" type="text" placeholder="入力してください…"></div>
            <div class="question-item"><img src="images/q6.png" class="riddle-img"><input id="q6" type="text" placeholder="入力してください…"></div>
            <div class="question-item"><img src="images/q7.png" class="riddle-img"><input id="q7" type="text" placeholder="入力してください…"></div>

        </div>

        <button id="check-step1" class="btn">回答を送信</button>
        <div id="feedback-message"></div>
    </div>


    <!-- ステップ2 -->
    <div id="step2" class="hidden">
        <h1>最終問題</h1>
        <img id="riddle-image" src="images/last.png">
        <p>7つの答えを使って最後のキーワードを導き出せ。</p>

        <input id="final-q" type="text" placeholder="入力してください…" style="margin-bottom:20px;">
        <button id="check-step2" class="btn">最終回答</button>
        <div id="final-feedback-message"></div>
    </div>


    <!-- CLEAR -->
    <div id="step3" class="hidden">
        <h1 class="clear-title">CLEAR!!!</h1>
        <p>Congratulations！あなたはすべての謎を解き明かした！</p>
        <a id="slack-link" class="btn slack-btn" target="_blank">サークルへ参加する</a>
    </div>

    <!-- 裏クリア -->
    <div id="step-secret-clear" class="hidden">
        <h1 class="sparkle-text">裏クリア成功！</h1>
        <p>すごい！あなたはリアル脱出ゲームに向いている！</p>
        <a id="secret-slack-link" class="btn slack-btn" target="_blank">サークルへ参加する</a>
    </div>

</div>

<script>
document.addEventListener("DOMContentLoaded", () => {

    /* ===== 設定（ここだけ変えればOK） ===== */
    const config = {
        step1Answers: ["こたえ","こたえ","こたえ","こたえ","こたえ","こたえ","こたえ"],
        step2Answer: "みくしいなぞとき",
        slackUrl: "https://mixigroup.enterprise.slack.com/archives/CKE9M28P8"
    };
    /* ======================================= */

    const step1 = document.getElementById("step1");
    const step2 = document.getElementById("step2");
    const step3 = document.getElementById("step3");
    const stepSecretClear = document.getElementById("step-secret-clear");
    const clearBg = document.getElementById("clear-bg");

    document.getElementById("slack-link").href = config.slackUrl;
    document.getElementById("secret-slack-link").href = config.slackUrl;

    const inputs = [
        q1, q2, q3, q4, q5, q6, q7
    ];

    /* ======= ステップ1：個別判定 ======= */
    document.getElementById("check-step1").onclick = () => {

        const answers = inputs.map(i => i.value.trim());
        const correct = config.step1Answers;

        // 裏クリア：全部「ひらがな」
        if (answers.every(a => a === "ひらがな")) {
            step1.classList.add("hidden");
            stepSecretClear.classList.remove("hidden");
            return;
        }

        // 個別判定
        const incorrectList = [];
        answers.forEach((ans, i) => {
            if (ans.toLowerCase() !== correct[i].toLowerCase()) {
                incorrectList.push(`謎${i+1}`);
            }
        });

        if (incorrectList.length > 0) {
            document.getElementById("feedback-message").textContent =
                incorrectList.join(" と ") + " が違います。";
            return;
        }

        // 全問正解 → 最終問題へ
        step1.classList.add("hidden");
        step2.classList.remove("hidden");
    };


    /* ======= ステップ2：最終問題 ======= */
    document.getElementById("check-step2").onclick = () => {

        const final = document.getElementById("final-q").value.trim().toLowerCase();

        if (final !== config.step2Answer.toLowerCase()) {
            document.getElementById("final-feedback-message").textContent = "答えが違います。";
            setTimeout(() => document.getElementById("final-feedback-message").textContent = "", 1500);
            return;
        }

        // CLEAR → 豪華演出
        step2.classList.add("hidden");
        step3.classList.remove("hidden");
        clearBg.classList.remove("hidden");
    };

});
</script>

</body>
</html>
